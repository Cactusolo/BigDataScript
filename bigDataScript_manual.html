<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>BigDataScript</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Styles -->
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/bootstrap-responsive.css" rel="stylesheet">
    <link href="css/docs.css" rel="stylesheet">
    <link href="js/google-code-prettify/prettify.css" rel="stylesheet">
	<link href="css/my.css" rel="stylesheet">

    <!-- hTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="ico/apple-touch-icon-114-precomposed.png">
      <link rel="apple-touch-icon-precomposed" sizes="72x72" href="ico/apple-touch-icon-72-precomposed.png">
                    <link rel="apple-touch-icon-precomposed" href="ico/apple-touch-icon-57-precomposed.png">
                                   <link rel="shortcut icon" href="ico/favicon.png">

  </head>

  <body data-spy="scroll" data-target=".bs-docs-sidebar">

    <!-- Navbar
    ================================================== -->
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="brand" href="#">BigDataScript</a>
          <div class="nav-collapse collapse">
            <p class="navbar-text pull-right">
            </p>
            <ul class="nav">
              <li class="active"><a href="index.html">Home</a></li>
              <li><a href="https://github.com/pcingola/BigDataScript">Download</a></li>
              <li><a href="bigDataScript_manual.html">Documentation</a></li>
              <li><a href="about.html">About</a></li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

<!-- Subhead
================================================== -->
<header class="jumbotron subhead" id="overview">
  <div class="container">
    <h1>BigDataScript</h1>
    <p class="lead">Documentation</p>
  </div>
</header>


  <div class="container">

    <!-- Docs nav
    ================================================== -->
    <div class="row">
      <div class="span3 bs-docs-sidebar">
        <ul class="nav nav-list bs-docs-sidenav">
          <li><a href="#install"><i class="icon-chevron-right"></i> Download &amp; Install</a></li>
          <li><a href="#intro"><i class="icon-chevron-right"></i> Introduction</a></li>
          <li><a href="#myfirst"><i class="icon-chevron-right"></i> Video: My first bds script</a></li>
          <li><a href="#task"><i class="icon-chevron-right"></i> Video: Scheduling tasks</a></li>
          <li><a href="#taskCluster"><i class="icon-chevron-right"></i> Video: Scheduling tasks on a cluster</a></li>
          <li><a href="#taskDep"><i class="icon-chevron-right"></i> Video: Creating pipelines: Task dependencies</a></li>
          <li><a href="#taskDep2"><i class="icon-chevron-right"></i> Video: More on task dependencies </a></li>
          <li><a href="#cool"><i class="icon-chevron-right"></i> Video: Some cool features </a></li>
          <li><a href="#language"><i class="icon-chevron-right"></i> Language definition </a></li>
          <li><a href="#dataTypes"><i class="icon-chevron-right"></i> Data type </a></li>
          <li><a href="#sys"><i class="icon-chevron-right"></i> Sys &amp; Task </a></li>
        </ul>
      </div>
      <div class="span9">


        <!-- ================================================== -->
        <section id="install">
          <div class="page-header">
            <h1>1. Download &amp; Install</h1>
          </div>
				<p class="lead"> BigDataScript a scripting language for big data pipelines.  </p>
				<p>
				The source code is available on <a href="https://github.com/pcingola/BigDataScript">GitHub </a>.
				How to install:
<pre>
# Clone repository
$ git clone https://github.com/pcingola/BigDataScript.git

# Run 'install script
$ cd BigDataScript
$ ./scripts/install.sh
</pre>

				Then edit your <code>.bashrc</code> (or <code>.bash_profile</code>) and add the following lines
<pre>
# BigDataScript
export CLASSPATH=$CLASSPATH:$HOME/.bds/BigDataScript.jar
export PATH=$PATH:$HOME/.bds/
</pre>

				Optionally, if you have root access, you can do the following (to get <code>bds</code> available everywhere in your system
<pre>
$ su -
# cd /usr/bin/
# ln -s /home/your_user/.bds/bds
</pre>

				</p>
				<h3> Licencing </h3>
				<p>
				Open source.
				</p>
				<h3> Source code</h3>
				<p>
				The source code is available on <a href="https://github.com/pcingola/BigDataScript">GitHub </a>.
				</p>
				<h3> Software archtecture </h3>
				<p>
				The source code is mostly written in Java and it has some parts in <a href="http://golang.org/">Go</a>. We use <a href="http://www.antlr.org/">ANTLR</a> as Lexer &amp; parser.
				<br>
				If you want to develop, you'll need:
				<ul>
					<li> Java (at least 1.6)
					<li> Go compiler (at least 1.0)
					<li> Git
				</ul>
				<br>
				</p>
			
        </section>

        <!-- ================================================== -->
        <section id="intro">
          <div class="page-header">
            <h1>2. Introduction</h1>
          </div>
				<p class="lead">
				BigDataScript is intended as a scripting language for big data pipeline. 
				</p>
				<p>
				You can think about BigDataScript (or <code>bds</code> for short) as a "shell scripting on steroids".
				</p>
				<p>
				If you have to run a sequence of multiple programs on your computer, you usually create a simple shell script.
				This does not scale for big computers such as clusters or many cloud instances.
				Creating scripts becomes complicated and platform dependent.
				<br>
				So the problem with current programming models for big data pipelines, is that they are just a pain. 
				You have very efficienet programs to solve particular problems, but as soon as you need to integrate them into a pipeline it's a nighmare.
				</p>
				<p>
				The main idea behind BigDataScript is quite simple, creating a script for big data should be as easy as creating a shell script.
				Furthermore, the same script should run without any changes no matter how big the computer is.
				It doesn't matter if you are programming and debugging it on your laptop, running it on a cluster or deploying it on a Cloud (Amazon or whatever you use).
				The same "data pipeline" (or script) should run without any changes.
				</p>

				<i class="icon-warning-sign"></i> BigDataScript is experimental and under heavy development. 
				At this time this is not for the faint of heart.
				
				<p class="lead">
				<b> Benefis of BigDataScript </b>
				</p>
				<ul>
					<li> <b>Reduced development time</b> 
					<p>
					The benefits are mainly to reduce development and debugging time.
					If you've spent time waiting for a process to run on a cluster, just to get an error in your code, you know what I mean.
					You should be able to run a small version on your laptop, debug immediatly, deploy when it's done.
					Shorter development cycles means better software.
					</p>

					<li> <b>System independent</b> 
					<p>
					As we just mentioned, the same program runs on a laptop, server, server farm, cluster or cloud.
					No changes to the program required.
					</p>

					<li> <b>Easy to learn</b> 
					<p>
					If you have experience programming any language, the syntax should be fairly familiar to you.
					It should be a no-brainer to read and write code.
					</p>

					<li> <b>Automatic Checkpointing</b> 
					<p>
					If any task fails to execute, BigDataScript creates a checkpoint file, serializing all the information from the program.
					What to re-start were it left? No problem, just run from the checkpoint.
					</p>

					<li> <b>Automatic logging</b> 
					<p>
					Everything is logged by default, no explicit actions required.
					Every time you execute a system command or a task, a set of files log which commands were executed, stdout &amp; stderr and exit codes.
					</p>

					<li> <b>Task scheduling and cancelation is done for you</b> 
					<p>
					You have a BigDataScript running on a terminal, then you realized there is something you don't like...just hit Ctrl-C.
					All tasks will be terminated, removed from the queue, deallocated from the cluster, etc.
					</p>

					<li> <b>Task dependencies</b> 
					<p>
					In complex pipelines tasks usually depend on each other.
					BigDataScript provides ways to easily manage task dependecies.
					</p>

					<li> <b>Avoid re-work</b> 
					<p>
					This concept has been arround since "make" program was created for compiling. 
					If we spend time processing to create a results file, we don't need to do the job again just bcause we are re-sunnig the pipeline.
					Task dependency using timestamps is provided at basic language level to make this easy.
					</p>
				</ul>

				<h3> What BigDataScript is not</h3>
				<p>
				BigDataScript is a language to create pipelines and it is, in many ways, analogous to "shell scripting". 
				You use it to "glue" programs toghether, but you would never use shell scripting to perform heavyweight computations.
				You don't care if <code>bash</code> takes a few miliseconds more to invoke a program, just because the running time of the program is usually much longer.
				Similarly you don't really care about performance characteristics of <code>bds</code>.
				<br>
				Think about it this way: If you are invoking a set of programs to perform big data computations, these programs usually take hours (or sometimes days) to run.
				The fact that bds takes a few miliseconds more to invoke the program, or to schedule the program in a cluster queue, really doesn't make any difference.
				<p>
				<b>Bottom line:</b> You use specialized programs to perform heavy weight computations and use <code>BigDataScript</code> to glue thos programs toghether.
				</p>
        </section>

        <!-- ================================================== -->
        <section id="myfirst">
          <div class="page-header">
            <h1>3. Video: My first bds script </h1>
          </div>
				<p class="lead">
				Here we show an introduction to BigDataScript (<code>bds</code>) command line.
				<p>
				
				<iframe width="640" height="390" src="http://www.youtube.com/embed/WnwBIa4G-mE" frameborder="0" allowfullscreen></iframe>
				
				<p class="lead"> In this video <p>
				<ul>
					<li> Running the command line without arguments, shows a small help
<pre>
$ bds
Error: Missing program file name.
Usage: BigDataScript [options] file.bds
BigDataScript 0.7 (build 2013-03-08), by Pablo Cingolani


Available options: 
  [-c | -config] file    : Config file. Default : /home/pcingola/.bds/bigdatascript.config
  [-d | -debug]          : Debug mode.
  [-r | -restore] file   : Restore from checkpoint file.
  [-v | -verbose]        : Be verbose.
  [-pid] <file>          : Write local processes PIDs to 'file'
  -noLog                 : Do not log stats.
</pre>

					<li> Create a simple program to print "Hi", and execute the script
<pre>
$ cat z.bds 
print("Hi\n")
$ bds z.bds 
Hi
</pre>

					<li> Running system command is done using a <code>sys</code> expression. 
					A sys command is sequencial, so the program does not continue until the system command returns.
<pre>
$ cat z.bds
sys echo Hi
$ bds z.bds
Hi
</pre>

					<li> Running complex tasks can be done using a <code>task</code> expression.
					A <code>task</code> command is queued for execution. 
					So the program can continue even if the task has not finished (or has not even started) execution.
					<br>
					<i class="icon-warning-sign"></i> Task execution order is not waranteed (e.g. a cluster scheduler can decide to run task_2 before task_1).
					We'll see how to coordinate tasks later.
<pre>
$ cat z.bds
sys echo Hi
$ bds z.bds
Hi
</pre>
				</ul>
				</p>
        </section>

        <!-- ================================================== -->
        <section id="task">
          <div class="page-header">
            <h1>4. Video: Scheduling tasks </h1>
          </div>
				<p class="lead">
				Task are scheduled according to available resources.
				<p>
				
				<iframe width="640" height="390" src="http://www.youtube.com/embed/ehFfU8vLwi8" frameborder="0" allowfullscreen></iframe>
				</p>
				
				<p class="lead"> In this video <p>
				<ul>
					<li> Schedule 10 tasks to be executed
<pre>
$ cat z.bds
for( int i=0 ; i < 10 ; i++ ) {
	task echo Hi $i ; sleep 1 ; echo Done $i ; sleep 1
}
$ bds z.bds
Hi 1
Hi 6
Hi 2
Hi 4
Hi 3
Hi 7
Hi 0
Hi 5
Done 1
Done 6
Done 2
Done 4
Done 3
Done 7
Done 0
Done 5
Hi 9
Hi 8
Done 9
Done 8
</pre>

        <!-- ================================================== -->
        <section id="taskCluster">
          <div class="page-header">
            <h1>5. Video: Scheduling tasks on a cluster </h1>
          </div>
				<p class="lead">
				Here we show how exactly the same script is run on a cluser...not a single line of code changed.
				<p>
				
				<iframe width="640" height="390" src="http://www.youtube.com/embed/o47wxUdYzvk" frameborder="0" allowfullscreen></iframe>
				</p>
				
				<p class="lead"> In this video <p>
				<ul>
					<li> We copy tha same script (used in the previous section) to a cluster. 
					We execute it, but now the tasks are schedules using MOAB, Torque or Grid Engine.
					<br>
					The only change we made is to add <code>-s cluster</code> to the command line. 
<pre>
$ bds -s cluster z.bds
</pre>

					<li> Typing <code>-s cluster</code> can also be avoided just using a config file.

				</ul>
        </section>

        <!-- ================================================== -->
        <section id="taskDep">
          <div class="page-header">
            <h1>6. Creating pipelines: Task dependencies</h1>
          </div>
				<p class="lead">
				In a tipical pipeline tasks are not just scheduled for execution.
				We need to be able to control task based on previously executed tasks.
				Here we show how.
				<p>
				
				<iframe width="640" height="390" src="http://www.youtube.com/embed/vTekXn3sKzs" frameborder="0" allowfullscreen></iframe>
				</p>
				
				<p class="lead"> In this video <p>
				<ul>
					<li> 
					We run a set of tasks (<code>echo Hi $i</code>) and after all the tasks finished, we run another set of tasks (<code>echo Bye $i</code>)
					<br>
					The only change we made is to add <code>-s cluster</code> to the command line. 
<pre>
$ bds z.bds
Before wait
Hi 7
Hi 1
Hi 3
Hi 6
Hi 4
Hi 2
Hi 5
Hi 0
Hi 9
Hi 8
After wait
Bye 2
Bye 1
Bye 3
Bye 0
Bye 5
Bye 7
Bye 6
Bye 4
Bye 8
Bye 9
</pre>

					<li> The <code>wait</code> statement is like a barrier. Untill all tasks are finished, the program does not continue.
					If any task fails, a checkpoint file is created, where all program data is serialized.
					We can correct the problem and re-start the pipeline were it left.

					<li> The <code>wait</code> statement can wait for all tasks, for single tasks or for a list of tasks.

					<li> We then run the same script on a cluster. 
					Again, this is done simply by using <code>-s cluster</code> command line.
					The video shows how tasks are scheduled and on the cluster, always honoring the <code>wait</code> statement

					<li> Finally we show that the exit code of a <code>bds</code> script is 0 if all tasks executed without any problems, and non-zero if there were probelms.

				</ul>
        </section>

        <!-- ================================================== -->
        <section id="taskDep2">
          <div class="page-header">
            <h1>7. Video: More on task dependencies </h1>
          </div>
				<p class="lead">
				If we already processed a file and have the results, we may choose to save some work if the input has not changed.
				We show how to execute tasks depending on file creation times (think "make").
				<p>
				
				<iframe width="640" height="390" src="http://www.youtube.com/embed/oSjhkRuc0I8" frameborder="0" allowfullscreen></iframe>
				</p>
				
				<p class="lead"> In this video <p>
				<ul>
					<li> We introduce the dependency operator <code>&lt;-</code> (pronounced 'dep') which is a "make" style operator.

					<li> The expression <code>out &lt;- in</code> is true if 'out' file needs to be updated.
					More formally, the expression is true if the file name represented by the variable 'out' does not exists, is empty (zero length) or has a creation date before 'in'.<br>
					E.g.:
<pre>
$ cat z.bds
string inFile = "in.txt"
string outFile = "out.txt"

tash echo Creating $inFile; echo Hello > $inFile

wait

if( outFile <- inFile ) {
	task echo Creating $outFile; cat $inFile > $outFile
}

$ bds z.bds
Creating in.txt
Creating out.txt

$ cat out.txt
Hello
</pre>

					<li> If the file 'out.txt' is up to date, the the following code will not execute
<pre>
if( outFile <- inFile ) {
	task echo Creating $outFile; cat $inFile > $outFile
}
</pre>

					<li> This construction is so common, that we allow for some sintactic sugar. 
					So you can write it the following way:
<pre>
task( outFile <- inFile ) { 
	sys echo Creating $outFile; cat $inFile > $outFile
}
</pre>
				</ul>
        </section>

        <!-- ================================================== -->
        <section id="cool">
          <div class="page-header">
            <h1>8. Video: Some cool features </h1>
          </div>
				<p class="lead">
				BigDataScript has some useful features, like automatic command line parsing.
				<p>
				
				<iframe width="640" height="390" src="http://www.youtube.com/embed/oSjhkRuc0I8" frameborder="0" allowfullscreen></iframe>
				</p>
				
				<p class="lead"> In this video <p>
				<ul>
					<li> We show how automatic command line parsing works.
					We use the same script as shown in the previous section for processing another input file without changing a single line of code.
					
					<li> Automatic command line parsing parses any command line argument that starts with "-" and assigns the value to the corresponding variable.
					E.g.:
<pre>
$ cat z.bds 
string in = "in.txt"
print("In file is '$in'\n")

$ bds z.bds
In file is 'in.txt'

$ bds z.bds -in anotherFile.txt
In file is 'anotherFile.txt'
</pre>

				<li> This feature also works for other data types (int, real, bool). 
				In case of bool if the option is present, the variable is set to 'true'.
<pre>
$ cat z.bds
bool flag
print("Variable flag is $flag\n")

$ bds z.bds
Variable flag is false

$ bds z.bds -flag
Variable flag is true

</pre>

				</ul>
        </section>

        <!-- ================================================== -->
        <section id="language">
          <div class="page-header">
            <h1>9. Language definition </h1>
          </div>
				<p class="lead">
				BigDataScript language is almost trivial, here are some basic definitions in case you are curious.
				</p>
				<p>
				Statements can be terminated either by semicolon or by a new line.
				<br>
				All the usual statements are available:
				<ul>
					<li> Comments
<pre>
// Single line comment

# Another single line comment

/*
   Multi-line comment
*/
</pre>
					<li> <code>if / else</code> It does exactly what you expect
<pre>
if( i < 10 )	print("Less than ten\n")
</pre>
					or
<pre>
if( i < 10 ) {
	print("Less than ten\n")
} else {
	print("More than ten\n")
}
</pre>

					<li> <code>for</code> C or Java like for statement
<pre>
for( int i=0 ; i < 10 ; i++ ) print("$i\n")
</pre>
					or
<pre>
for( int i=0 ; i < 10 ; i++ ) {
	print("$i\n")
}
</pre>

					<li> <code>for</code> Java like for iterator on lists
<pre>
string[] mylist
// Some code to populate the list
for( string s : mylist ) print("$s\n")
</pre>

					<li> <code>while</code> typical while iterator
<pre>
while( i < 10 ) i++
</pre>

					<li> <code> break </code>: Breaks from current loop
					<li> <code> continue </code>: Continue at the end of the current loop
					<li> <code> exit expression?</code>: Exit program, optional expression calculates an exit value.
					<li> <code> kill </code> Kill a task
					<li> <code> wait expression?</code> Wait for task/s to finish. It can be one task, a list of tasks or all tasks (if no expression)
					<li> <code> checkpoint expression?</code> Create a checkpoint. Optional expresion is a file name
					<li> <code> return expression?</code> Return from a function. Optional expression is a return value.
				</ul>

				<br>
				<br>
				A simple, and useless, example:
<pre>
// Define a function
int sumPositive(int n) {
    if( n <= 0 )    return 0

    int sum = 0
    for( int i=0 ; i <= n ; i++ ) sum = sum + i
    return sum
}


// Main
int N = 10
print("The sum is : " + sumPositive(N) + "\n" )
</pre>
				Obviously, if you run it
<pre>
$ bds z.bds 
The sum is : 55
</pre>
				</p>

				
        </section>

        <!-- ================================================== -->
        <section id="dataTypes">
          <div class="page-header">
            <h1>10. Data types </h1>
          </div>
				<p class="lead">
				Statically typed language.
				<p>

				<h3> Only a few simple types</h3>
				The language is statically typed. 
				The intention is to avoid runtime errors.
				<br>
				<br>
				There are only a few basic types :

				<table class="table table-striped">
					<tr> <th> Type   </th> <th> Meaning </th> </tr>
					<tr> <td> string </td> <td> A string (same a Java's String) </td> </tr>
					<tr> <td> int    </td> <td> A 64 bit integer number (same a Java's long) </td> </tr>
					<tr> <td> real   </td> <td> A 64 bit IEEE 754 number (same as Java's double) </td> </tr>
					<tr> <td> bool   </td> <td> A boolean value, can be 'true' or 'false' (same as Java's boolean)</td> </tr>
					<tr> <td> Arrays, List, Stacks   </td> <td> These are all the same, just a different way to call a list of elements</td> </tr>
					<tr> <td> Maps   </td> <td> Maps are not currently supported. They will be implemented soon </td> </tr>
				</table>

				There is no "null" element. Again, the idea is to minimize points of failura.

				
				<h3> Strings </h3>
				There are several basic methods defined for strings:

				<table class="table table-striped">
					<tr> <th>Return type</th><th> Method / Operator</th> <th> Meaning </th> </tr>
					<tr> <td> string   </td><td> s = s1 + s2							</td> <td> Concatenate strings.</td> </tr>
					<tr> <td> string   </td><td> string.toUpper()						</td> <td> Return an upper case version of the string</td> </tr>
					<tr> <td> string   </td><td> string.toLower()						</td> <td> Return a lower case version of the string</td> </tr>
					<tr> <td> string   </td><td> string.trim()							</td> <td> Trim spaces at the beginnig and at the end</td> </tr>
					<tr> <td> string   </td><td> string.substr(int start,int end)       </td> <td> Substring from start to end</td> </tr>
					<tr> <td> string[] </td><td> string.split(string regex)				</td> <td> Split using a regular expression </td> </tr>
					<tr> <td> string[] </td><td> string.lines()							</td> <td> Split a string into lines </td> </tr>
					<tr> <td> bool     </td><td> string.isEmpty()                       </td> <td> True if the string is empty</td> </tr>
					<tr> <td> bool     </td><td> string.startsWith(string str)			</td> <td> True if string starts with str</td> </tr>
					<tr> <td> bool     </td><td> string.endsWith(string str)			</td> <td> True if string ends with str</td> </tr>
					<tr> <td> bool     </td><td> string.indexOf(string str)				</td> <td> Index of th first occurrence of str in string</td> </tr>
					<tr> <td> int      </td><td> string.lastIndexOf(string str)			</td> <td> Index of th last occurrence of str in string</td> </tr>
					<tr> <td> string   </td><td> string.replace(string str1,string str2)</td> <td> A new string replacing 'str1' with 'str2'</td> </tr>
				</table>

				<h3> Strings as file names </h3>
				Strings can be used in several different ways.
				For instance, it is common that a string can represent a file name in a script.
				So you can use 'file' related methods on string.
				E.g.:
<pre>
string f = "in.txt"
if( f.canRead() ) {
	print (" Can read file $f\n" )
}
</pre>
				Here <code>f</code> is a string, but it has a method <code>canRead()</code> which retuurns true if f is a file and it can be read.
				<br>
				<br>
				More file related methods:

				<table class="table table-striped">
					<tr> <th>Return type</th><th> Method</th> <th> Meaning </th> </tr>
					<tr><td>string        </td> <td>string.path()                      </td> <td> Canonical path to file    </td> </tr>
					<tr><td>string        </td> <td>string.baseName()                  </td> <td> File's base name    </td> </tr>
					<tr><td>string        </td> <td>string.baseName(string ext)        </td> <td> File's base name, remove extention 'ext'    </td> </tr>
					<tr><td>string        </td> <td>string.dirName()                   </td> <td> File's directory name    </td> </tr>
					<tr><td>string        </td> <td>string.extName()                   </td> <td> File's extension    </td> </tr>
					<tr><td>bool          </td> <td>string.canRead()                   </td> <td> True if file has read permission    </td> </tr>
					<tr><td>bool          </td> <td>string.canWrite()                  </td> <td> True if file has write permission   </td> </tr>
					<tr><td>bool          </td> <td>string.canExec()                   </td> <td> True if file has execution permission    </td> </tr>
					<tr><td>bool          </td> <td>string.exists()                    </td> <td> True if file exists    </td> </tr>
					<tr><td>bool          </td> <td>string.isDir()                     </td> <td> True if it's a directory    </td> </tr>
					<tr><td>bool          </td> <td>string.isFile()                    </td> <td> True if it's a file    </td> </tr>
					<tr><td>bool          </td> <td>string.delete()                    </td> <td> Delete file    </td> </tr>
					<tr><td>bool          </td> <td>string.mkdir()                     </td> <td> Create dir ('mkdir -p')   </td> </tr>
					<tr><td>string        </td> <td>string.read()                      </td> <td> Read the whole file into a string    </td> </tr>
					<tr><td>string[]      </td> <td>string.readLines()                 </td> <td> Read the whole file and split the lines    </td> </tr>
					<tr><td>string[]      </td> <td>string.dir()                       </td> <td> List files in a directory ('ls')   </td> </tr>
					<tr><td>string[]      </td> <td>string.dir(string regex)           </td> <td> List files matching a regular expression </td> </tr>
					<tr><td>string[]      </td> <td>string.dirPath()                   </td> <td> List files using canonical paths    </td> </tr>
					<tr><td>string[]      </td> <td>string.dirPath(string regex)       </td> <td> List files, matching a regular expresion, using canonical paths    </td> </tr>
					<tr><td>int           </td> <td>string.size()                      </td> <td> File size in bytes  </td> </tr>
				</table>
				
				<h3> Strings as task IDs </h3>
				Strings can also be used to refer to tasks.
				When a task is created, the <code>task</code> expression returns a task ID, which is a string.
				This task ID can be used for task operations, for instance:
<pre>
string tid = task echo Hello
wait tid
</pre>
				Here the <code>wait</code> statement will wait until the task "echo Hello" finishes executing.
				<br>
				<br>
				More task related methods:
				<table class="table table-striped">
					<tr> <th>Return type</th><th> Method</th> <th> Meaning </th> </tr>
					<tr> <td> bool    </td> <td> string.isDone()   </td> <td> True if the task finished</td> </tr>
					<tr> <td> bool    </td> <td> string.isDoneOk() </td> <td> True if the task finished without errors </td> </tr>
					<tr> <td> string  </td> <td> string.stdout()   </td> <td> A string with all the STDOUT generated from this task </td> </tr>
					<tr> <td> string  </td> <td> string.stderr()   </td> <td> A string with all the STDERR generated from this task </td> </tr>
					<tr> <td> int     </td> <td> string.exitCode() </td> <td> Exit code</td> </tr>
				</table>

				<h3> Arrays, List, Stacks </h3>
				Arrays, list and stacks are all the same thing.
				You can create a list of strings simply by declaring <code> string[] myStringList </code>. 
				Similarly, a list of ints is just <code> int[] myIntList </code>. 
				<br>
				<br>
				Methods:
				<table class="table table-striped">
					<tr> <th>Returns </th><th> Method</th> <th> Meaning </th> </tr>
					<tr> <td> Element added  </td> <td> add </td> <td> Add at the end og the list </td> </tr>
					<tr> <td> First element  </td> <td> head </td> <td> Get first element </td> </tr>
					<tr> <td> Last element  </td> <td> pop </td> <td> Get last element and remove it from the list </td> </tr>
					<tr> <td> Element pushed  </td> <td> push </td> <td> Add at the end of the list </td> </tr>
					<tr> <td> int </td> <td> size() </td> <td> Return the number of elements in the list </td> </tr>
					<tr> <td> New sorted list </td> <td> sort() </td> <td> Create a new list sorting the elements of this list</td> </tr>
					<tr> <td> List  </td> <td> tail() </td> <td> Create a new list with all but the first element</td> </tr>
				</table>
				</p>
        </section>

        <!-- ================================================== -->
        <section id="sys">
          <div class="page-header">
            <h1>12. Sys &amp; Task types </h1>
          </div>
				<p class="lead"> Command execution and coordination.  <p>

				<h3> Sys </h3>
				A <code>sys</code> statement immediately executes a command (an OS command) in the local machine.
				BigDataScript executions is suspended until the command terminates.
				If the command exits with an error condition, the bds program creates a checkpoint, and exits with a non-zero exit code.
				<br>
				<br>
				<i class="icon-warning-sign"></i>  SYS expressions are executed in the local computer without looking at resources consumed.
				<br>
				<br>
				E.g.
<pre>
$ cat z.bds
print("Before\n")
sys echo Hello
print("After\n")

$ bds z.bds
Before
Hello
After
</pre>

				Everything after a <code>sys</code> keyword until the end of the line is considered part of the command to be executed.
				So mutiple commands can be separated by semicolon
<pre>
sys echo Hello ; echo Bye
</pre>

				Multi-line stalements are allowed, by using a back-slash at the end of the line
<pre>
sys echo HeLLo \
    | tr [A-Z] [a-z]
</pre>
				This program prints <code>hello</code> (all lower case)
				<br>
				<br>
				<h3> Logging </h3>
				Both <code>sys</code> and <code>task</code> commands create a shell file, execute it and save STDOUT and STDERR to files.
				This gives you an automatic log of everything that was executed, as well as the detials of the outputs from each execution.
				<br>
				For example, let's create a simple program and run it
<pre>
string name = "Pablo"

sys echo Hello $name
</pre>

				Now let's run this script, we use <code>-v</code> command line option to make the output verbose:
<pre>
[pcingola@localhost zzz]$ bds -v z.bds
00:00:00.169	Process ID: z.bds.20130328_224825_685
00:00:00.174	Queuing task 'z.bds.20130328_224825_685/sys.line_4.id_1'
00:00:00.674	Running task 'z.bds.20130328_224825_685/sys.line_4.id_1'
00:00:00.689	Finished task 'z.bds.20130328_224825_685/sys.line_4.id_1'
Hello Pablo
00:00:00.692	Finished running. Exit value : 0
</pre>
				What happened?
				<ol>
					<li> bds parses the <code>sys</code> statement and interpolates "echo Hello $name" to "echo Hello Pablo"

					<li> Creates a taks and assigns a task ID <code>z.bds.20130328_224825_685/sys.line_4.id_1</code>

					<li> It creates a shell script file <code>z.bds.20130328_224825_685/sys.line_4.id_1.sh</code> with the code:
<pre>
$ cat z.bds.20130328_224825_685/sys.line_4.id_1.sh 
#!/bin/sh

echo Hello Pablo
</pre>

					<li> Then executes this shell script and saves stdout and stderr to z.bds.20130328_224825_685/sys.line_4.id_1.stdout and z.bds.20130328_224825_685/sys.line_4.id_1.stderr respectively
<pre>
$ cat z.bds.20130328_224825_685/sys.line_4.id_1.stdout
Hello Pablo
$ cat z.bds.20130328_224825_685/sys.line_4.id_1.stderr
</pre>
					Notice that there was no output on stderr (it's empty)

					<li> Command finished without proglems, so it continues with the res of the program
				
				</ol>
				So at the end of the run, we have the file with the script, plus the stdout and stderr files.
				All the information is logged automatically.
				<br>

				<h3> Task </h3>

				</p>
        </section>

        <!-- ================================================== -->
        <section id="check">
          <div class="page-header">
            <h1>13. Checkpoints </h1>
          </div>
				<p class="lead"> Fully serializable program states and checkpoints help to recover complex pipelines.  <p>

				<br>
				<br>
        </section>
      </div>
    </div>

  </div>



    <!-- Footer
    ================================================== -->
      <footer>
        <p class="text-center">&copy; Pablo Cingolani 2013</p>
      </footer>


    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
    <script src="js/jquery.js"></script>
    <script src="js/bootstrap-transition.js"></script>
    <script src="js/bootstrap-alert.js"></script>
    <script src="js/bootstrap-modal.js"></script>
    <script src="js/bootstrap-dropdown.js"></script>
    <script src="js/bootstrap-scrollspy.js"></script>
    <script src="js/bootstrap-tab.js"></script>
    <script src="js/bootstrap-tooltip.js"></script>
    <script src="js/bootstrap-popover.js"></script>
    <script src="js/bootstrap-button.js"></script>
    <script src="js/bootstrap-collapse.js"></script>
    <script src="js/bootstrap-carousel.js"></script>
    <script src="js/bootstrap-typeahead.js"></script>
    <script src="js/bootstrap-affix.js"></script>

    <script src="js/holder/holder.js"></script>
    <script src="js/google-code-prettify/prettify.js"></script>

    <script src="js/application.js"></script>



  </body>
</html>
